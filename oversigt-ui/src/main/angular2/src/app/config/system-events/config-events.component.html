<app-header [title]="'Cached Events'" [additional]="search"></app-header>
<ng-template #search>
  <button class="btn btn-outline btn-icon btn-sm" (click)="reloadEvents()" title="Reload events"><clr-icon shape="refresh"></clr-icon></button>
  <div class="clr-control-container">
    <div class="clr-input-wrapper">
      <input class="clr-input" type="text" placeholder="Filter events" [(ngModel)]="filter"/>
    </div>
  </div>
</ng-template>

<nz-list [nzDataSource]="events | filterEventitem: filter" [nzRenderItem]="item" [nzItemLayout]="'horizontal'"
  [nzLoading]="events.length === null">
  <ng-template #item let-item>
    <nz-list-item [nzActions]="[eventSourceLink]">
      <nz-list-item-meta [nzTitle]="title" [nzDescription]="content">
        <ng-template #title>
          <a (click)="item.visible = !item.visible">{{item.event.id}}
            <i *ngIf="item.visible" nz-icon type="caret-down" theme="outline"></i>
            <i *ngIf="!item.visible" nz-icon type="caret-right" theme="outline"></i>
          </a>
        </ng-template>
        <ng-template #content>
          <pre *ngIf="item.visible">{{item.event | json}}</pre>
        </ng-template>
      </nz-list-item-meta>
      <ng-template #eventSourceLink>
        <app-eventsource-button [eventSourceId]="item.event.id"></app-eventsource-button>
      </ng-template>
    </nz-list-item>
  </ng-template>
</nz-list>
